<!doctype html>
<html lang='en'>
  <head>
    <meta name='twitter:card' content='summary' />
    <meta property='og:title' content='Creating a Command-Line Application in Kotlin' />
    <meta property='og:url' content='https://seansoper.com/blog/creating_command_line_app_kotlin.html' />
    <meta property='og:description' content='Many folks associate Kotlin with Android but its uses extend far beyond programming for mobile. We will be building a ‚ÄúHello World‚Äù command-line application packaged up as a JAR file, a format just about every Java developer should be familiar with. We will also make use of Github, Gradle and JetBrain‚Äôs IntelliJ IDEA, the gold standard in Java IDEs.' />
    <meta property='og:image' content='//source.unsplash.com/abJmDlB_570/1200x627' />
    <!-- Generated by zebec https://github.com/ssoper/Zebec -->
    <meta charset='utf-8' />
    <meta http-equiv='X-UA-Compatible' content='IE=edge' />
    <meta name='viewport' content='width=device-width, initial-scale=1, shrink-to-fit=no' />
    <meta name='ICBM' content='39.0840, 77.1528' />
    <title>eat. code. stocks.</title>
    <link type='image/x-icon' href='/favicon.ico' rel='shortcut icon' />
    <link type='application/rss+xml' title='eat. code. stocks.' href='/blog/rss.xml' rel='alternate' />
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src='https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js'></script>
      <script src='https://oss.maxcdn.com/respond/1.4.2/respond.min.js'></script>
    <![endif]-->
  </head>
  <body>
    <!-- Navigation -->
    <nav class='navbar navbar-expand-lg navbar-dark bg-dark fixed-top'>
      <div class='container'>
        <a class='navbar-brand' title='eat. code. stocks.' href='/blog'>üç± üë®üèª‚Äçüíª üè¶</a>
        <button class='navbar-toggler' type='button' data-toggle='collapse' data-target='#navbarResponsive' aria-controls='navbarResponsive' aria-expanded='false' aria-label='Toggle navigation'>
          <span class='navbar-toggler-icon'></span>
        </button>
        <div class='collapse navbar-collapse' id='navbarResponsive'>
          <ul class='navbar-nav ml-auto'>
            <li class='nav-item'>
              <a class='nav-link' href='/'>Home</a>
            </li>
            <li class='nav-item'>
              <a class='nav-link' href='/blog'>Blog</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <!-- Page Content -->
    <div class='container'>
      <div class='row'>
        <div class='col-lg-8 content'>
          <h1 class='mt-4'>Creating a Command-Line Application in Kotlin</h1><h2 class='subtitle'>From project creation to JAR file in three steps</h2><div class='author'>
  <img src='/images/avatar_normal.jpg' alt='' srcset='/images/avatar_normal.jpg 1x, /images/avatar_retina.jpg 2x'/>
  <ul>
    <li>Sean Soper</li>
    <li>September 27, 2020</li>
  </ul>
</div><img class='img-fluid rounded' alt='' src='//source.unsplash.com/abJmDlB_570/900x300' srcset='//source.unsplash.com/abJmDlB_570/900x300 1x, //source.unsplash.com/abJmDlB_570/1800x600 2x'><p>Many folks associate Kotlin with Android but its uses extend far beyond programming for mobile. We will be building a ‚ÄúHello World‚Äù command-line application packaged up as a <a href="https://docs.oracle.com/javase/tutorial/deployment/jar/index.html">JAR file</a>, a format just about every Java developer should be familiar with. We will also make use of Github, Gradle and JetBrain‚Äôs <a href="https://www.jetbrains.com/idea/">IntelliJ IDEA</a>, the gold standard in Java IDEs.</p><p>Note that this will heavily reference the <a href="https://github.com/ssoper/Batil">Batil repo</a>.</p><h2>Setup</h2><p>Let‚Äôs start with opening up IntelliJ and creating a new project. Click on <code>File</code> ‚û° <code>New</code> ‚û° <code>Project</code>.</p><img src="/images/blog/creating_command_line_app_kotlin/new_project.png" alt="New Project Screenshot" class="img-fluid rounded embedded">
<p>For the type of project select <code>Gradle</code> ‚û° <code>Kotlin/JVM</code>. Ensure a Java SDK is present in the <code>Project SDK</code> field which should be pre-filled with a sensible default.</p><img src="/images/blog/creating_command_line_app_kotlin/project_type.png" alt="Project Type Screenshot" class="img-fluid rounded embedded">
<p>Clicking <code>Next</code> will take you to a screen asking for the name of your project. Note that while there are subtle differences between capitalized vs. lower case project names they are mostly up to personal styles and can be modified in the project settings or Gradle files.</p><img src="/images/blog/creating_command_line_app_kotlin/project_names.png" alt="Project Names Screenshot" class="img-fluid rounded embedded">
<p>A summary of these changes can be found in <a href="https://github.com/ssoper/Batil/compare/691773c..aed9360">these commits</a>.</p><h2>Migrating to a Kotlin Gradle script</h2><p>While the default Gradle script file is fine, since we are using Kotlin let‚Äôs go ahead and make our Gradle script Kotlin as well. Rename the existing <code>build.gradle</code> file to <code>build.gradle.kts</code>. This will result in some errors popping up in the console as IntelliJ attempts to rebuild a now ‚Äúbroken‚Äù Gradle file but no biggie, we can quickly fix those. For instance, in the <code>plugins</code> section, items such as</p><pre><code>
id 'org.jetbrains.kotlin.jvm' version '1.4.10'
</code></pre><p>become</p><pre><code>
id(&quot;org.jetbrains.kotlin.jvm&quot;) version &quot;1.4.10&quot;
</code></pre><p>We‚Äôll also add a <code>publishing</code> section that we can use down the road for building a Maven dependency. This is what is provided by default.</p><pre><code>
plugins {	
    id 'org.jetbrains.kotlin.jvm' version '1.4.10'	
}	

group 'com.seansoper'	
version '1.0-SNAPSHOT'	

repositories {	
    mavenCentral()	
}	

dependencies {	
    implementation &quot;org.jetbrains.kotlin:kotlin-stdlib&quot;	
}
</code></pre><p>And here it is converted to Kotlin.</p><pre><code>
plugins {
    id(&quot;org.jetbrains.kotlin.jvm&quot;) version &quot;1.4.10&quot;
    id(&quot;maven-publish&quot;)
}

repositories {
    mavenCentral()
}

dependencies {
    implementation(&quot;org.jetbrains.kotlin:kotlin-stdlib&quot;)
}

publishing {
    publications {
        create&lt;MavenPublication&gt;(&quot;gpr&quot;) {
            run {
                groupId = &quot;com.seansoper&quot;
                artifactId = &quot;batil&quot;
                version = &quot;1.0.0&quot;
            }
        }
    }
}
</code></pre><p>Once these changes are made the Gradle script should correctly build and start code highlighting. A summary of these changes can be found in <a href="https://github.com/ssoper/Batil/compare/aed9360..31a628e">these commits</a>.</p><h2>Entrypoint</h2><p>We‚Äôll need to create a main entrypoint function where the app ‚Äústarts‚Äù. There are two approaches to doing this and differ really only in style than anything else. The first involves creating a <code>fun main</code> at the root level of a file while the second requires creating an <code>object</code> with a static main method inside of it. Personally I‚Äôm a fan of the 2nd method as I feel it allows for better organization. I also like to put this in a file named <code>Core.kt</code> which should be added to the <code>src/main/kotlin</code> directory as <code>New</code> ‚û° <code>Kotlin File/Class</code>.</p><pre><code>
package com.seansoper.batil

object Core {
    @JvmStatic fun main(args: Array&lt;String&gt;) {
        println(&quot;Hello World&quot;)
    }
}
</code></pre><h2>Building the JAR artifact</h2><p>At this point there should be no build errors or issues with Gradle. Starting with <code>Project Structure</code>, which is the icon in the upper right that looks like a folder with small squares on top of it, we will create an artifact build target by selecting <code>Artifacts</code> ‚û° <code>+</code> ‚û° <code>JAR</code> ‚û° <code>From modules with dependencies</code>.</p><img src="/images/blog/creating_command_line_app_kotlin/add_artifact.png" alt="Add Artifact Screenshot" class="img-fluid rounded embedded">
<p>The <code>Module</code> selected should be the one with <code>.main</code> appended and the <code>Main Class</code> should be the <code>Core</code> object we created earlier. Ensure <code>extract to the target JAR</code> is selected and modify the value for <code>META-INF/MANIFEST.MF</code> to use <code>resources</code>.</p><img src="/images/blog/creating_command_line_app_kotlin/artifact.png" alt="Artifact Screenshot" class="img-fluid rounded embedded">
<p>One more item to note is that you will need to update the <code>Modules</code> section. By default it uses the module compile output path but we need to update it to select <code>Inherit project compile output path</code>. If when running the JAR file there is an error about not being able to find the linked manifest this is often the cause of it.</p><img src="/images/blog/creating_command_line_app_kotlin/structure.png" alt="Artifact Structure Screenshot" class="img-fluid rounded embedded">
<p>Once these settings are updated hit <code>Apply</code> and then <code>Ok</code>. From there choose <code>Build</code> ‚û° <code>Build Artifact</code> and find the resulting JAR file somewhere in the <code>out/artifacts</code> subdirectory.</p><pre><code>
ssoper@rocinante Batil % java -jar out/artifacts/Batil_main_jar/Batil.main.jar
Hello World
</code></pre><p>Nice work! üôåüèª A summary of these changes can be found in <a href="https://github.com/ssoper/Batil/compare/31a628e..75c2cff">these commits</a>.</p><h2>Github</h2><p>I know some folks prefer to make their git repo first vs. their Kotlin project but just in case you did it the other way here‚Äôs an <a href="https://stackoverflow.com/questions/3311774/how-to-convert-existing-non-empty-directory-into-a-git-working-directory-and-pus">easy guide</a> to get your hard work into Github so it doesn‚Äôt get lost. After creating the repository in Github you can run these commands in your project directory.</p><pre><code>
git init .
git add .
git commit -m &quot;first commit&quot;
git remote add origin SSH URL TO REPO
git pull origin master --allow-unrelated-histories
git push --set-upstream origin master
git push
</code></pre><p>And of course don‚Äôt forget to add a <a href="https://github.com/ssoper/Batil/blob/master/.gitignore">gitignore</a>.</p>
        </div>
        <!-- Sidebar Widgets Column -->
        <div class='col-md-4'>
          <!-- Search Widget -->
          <div class='card my-4'>
            <h5 class='card-header'>Search</h5>
            <div class='card-body'>
              <div class='input-group'>
                <input class='form-control' placeholder='Search for‚Ä¶' id='search-query' type='text' />
                <span class='input-group-btn'>
                  <button class='btn btn-secondary' type='button' id='search-button'>Go!</button>
                </span>
              </div>
            </div>
          </div>
          <a href='/blog/rss.xml'><img width='72' src='https://shields.io/badge/rss-2.0-blue?logo=rss'></a>
        </div>
      </div>
    </div>
    <!-- jQuery -->
    <script integrity='sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n' crossorigin='anonymous' src='https://code.jquery.com/jquery-3.4.1.slim.min.js'></script>
    <!-- Popper -->
    <script integrity='sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo' crossorigin='anonymous' src='https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js'></script>
    <!-- Bootstrap -->
    <script integrity='sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6' crossorigin='anonymous' src='https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js'></script>
    <!-- highlight.js -->
    <script src='//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/highlight.min.js'></script>
    <!-- Delay loading of some assets for Google PageSpeed optimizations -->
    <noscript id='deferred-styles'>
      <link href='https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css' integrity='sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh' crossorigin='anonymous' rel='stylesheet' />
      <link href='/css/blog.min.css' rel='stylesheet' />
      <link href='//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/styles/default.min.css' rel='stylesheet' />
    </noscript>
    <script src='/js/load_deferred_styles.min.js'></script>
    <script src='/js/load_highlight.min.js'></script>
    <script src='/js/load_search.min.js'></script>
    <!-- Google Analytics -->
    <script async src='https://www.googletagmanager.com/gtag/js?id=G-N2516DN82V'></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-N2516DN82V');
    </script>
  </body>
</html>